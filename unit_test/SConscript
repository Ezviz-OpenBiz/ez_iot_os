from building import *

cwd     = GetCurrentDir()

src     = Glob('port/rt-thread/*.c')
src     += Glob('case/ut_ezlog.c')
src     += Glob('case/ut_online.c')
src     += Glob('case/ut_bind.c')
src     += Glob('case/ut_ezos_kv.c')
src     += Glob('case/ut_tsl.c')
src     += Glob('case/ut_gateway.c')

path    = [cwd + '/port/rt-thread']

defines = []
# defines = ['UTEST_TC_USE_CONSTRUCTOR']

if GetDepend(['EZIOT_UNIT_TEST_REPORT_LOGLVL']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_REPORT_LOGLVL=EZIOT_UNIT_TEST_REPORT_LOGLVL']
if GetDepend(['EZIOT_UNIT_TEST_SDK_LOGLVL']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_SDK_LOGLVL=EZIOT_UNIT_TEST_SDK_LOGLVL']
if GetDepend(['EZIOT_UNIT_TEST_CASE_TIEMOUT_SECONDS']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_CASE_TIEMOUT_SECONDS=EZIOT_UNIT_TEST_CASE_TIEMOUT_SECONDS']
if GetDepend(['EZIOT_UNIT_TEST_CLOUD_HOST']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_CLOUD_HOST=EZIOT_UNIT_TEST_CLOUD_HOST']
if GetDepend(['EZIOT_UNIT_TEST_CLOUD_PORT']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_CLOUD_PORT=EZIOT_UNIT_TEST_CLOUD_PORT']
if GetDepend(['EZIOT_UNIT_TEST_DEV_AUTH_MODE_SAP']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_AUTH_MODE_SAP=EZIOT_UNIT_TEST_DEV_AUTH_MODE_SAP']
if GetDepend(['EZIOT_UNIT_TEST_DEV_AUTH_MODE_LICENCE']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_AUTH_MODE_LICENCE=EZIOT_UNIT_TEST_DEV_AUTH_MODE_LICENCE']
if GetDepend(['EZIOT_UNIT_TEST_DEV_TYPE']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_TYPE=EZIOT_UNIT_TEST_DEV_TYPE']
if GetDepend(['EZIOT_UNIT_TEST_DEV_SERIAL_NUMBER']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_SERIAL_NUMBER=EZIOT_UNIT_TEST_DEV_SERIAL_NUMBER']
if GetDepend(['EZIOT_UNIT_TEST_DEV_VERIFICATION_CODE']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_VERIFICATION_CODE=EZIOT_UNIT_TEST_DEV_VERIFICATION_CODE']
if GetDepend(['EZIOT_UNIT_TEST_DEV_PRODUCT_KEY']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_PRODUCT_KEY=EZIOT_UNIT_TEST_DEV_PRODUCT_KEY']
if GetDepend(['EZIOT_UNIT_TEST_DEV_NAME']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_NAME=EZIOT_UNIT_TEST_DEV_NAME']
if GetDepend(['EZIOT_UNIT_TEST_DEV_LICENSE']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_LICENSE=EZIOT_UNIT_TEST_DEV_LICENSE']
if GetDepend(['EZIOT_UNIT_TEST_DEV_DISPLAY_NAME']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_DISPLAY_NAME=EZIOT_UNIT_TEST_DEV_DISPLAY_NAME']
if GetDepend(['EZIOT_UNIT_TEST_DEV_FIRMWARE_VERSION']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_DEV_FIRMWARE_VERSION=EZIOT_UNIT_TEST_DEV_FIRMWARE_VERSION']
if GetDepend(['EZIOT_UNIT_TEST_WIFI_SSID']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_WIFI_SSID=EZIOT_UNIT_TEST_WIFI_SSID']
if GetDepend(['EZIOT_UNIT_TEST_WIFI_PASSWORD']):
    defines += ['CONFIG_EZIOT_UNIT_TEST_WIFI_PASSWORD=EZIOT_UNIT_TEST_WIFI_PASSWORD']

group = DefineGroup('eziot_utest', src, depend = ['EZIOT_UNIT_TEST_ENABLE'], CPPPATH = path, CPPDEFINES = defines)

Return('group')